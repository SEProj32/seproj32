(window.webpackJsonp=window.webpackJsonp||[]).push([[335],{1090:function(e,t,o){"use strict";var n=o(877),i=o.n(n),c=o(2),a=o(8),r=o(321);var s=o(376);function l(e){class t extends c.Component{constructor(){super(...arguments),this.mounted=!1,this.state={channels:[],globalTypes:[],loading:!0,notifications:[],perProjectTypes:[]},this.fetchNotifications=()=>{Object(a.getJSON)("/api/notifications/list").catch(r.a).then(e=>{this.mounted&&this.setState({channels:e.channels,globalTypes:e.globalTypes,loading:!1,notifications:e.notifications,perProjectTypes:e.perProjectTypes})},()=>{this.mounted&&this.setState({loading:!1})})},this.addNotificationToState=e=>{this.setState(t=>{return{notifications:i()([...t.notifications,e],this.areNotificationsEqual)}})},this.removeNotificationFromState=e=>{this.setState(t=>{return{notifications:t.notifications.filter(t=>!this.areNotificationsEqual(t,e))}})},this.addNotification=e=>{this.addNotificationToState(e),function(e){return Object(a.post)("/api/notifications/add",e).catch(r.a)}({channel:e.channel,project:e.project,type:e.type}).catch(()=>{this.removeNotificationFromState(e)})},this.removeNotification=e=>{this.removeNotificationFromState(e),function(e){return Object(a.post)("/api/notifications/remove",e).catch(r.a)}({channel:e.channel,project:e.project,type:e.type}).catch(()=>{this.addNotificationToState(e)})},this.areNotificationsEqual=(e,t)=>e.channel===t.channel&&e.type===t.type&&e.project===t.project}componentDidMount(){this.mounted=!0,this.fetchNotifications()}componentWillUnmount(){this.mounted=!1}render(){const t=this.state,o=t.channels,n=t.globalTypes,i=t.loading,a=t.notifications,r=t.perProjectTypes;return c.createElement(e,Object.assign({},this.props,{addNotification:this.addNotification,channels:o,globalTypes:n,loading:i,notifications:a,perProjectTypes:r,removeNotification:this.removeNotification}))}}return t.displayName=Object(s.a)(e,"withNotifications"),t}o.d(t,"a",function(){return l})},1764:function(e,t,o){"use strict";o.r(t),o.d(t,"ProjectNotifications",function(){return b});var n=o(2),i=o(310),c=o(326),a=o.n(c),r=o(361),s=o.n(r),l=o(319),d=o(314),h=o.n(d),p=o(5),u=o(1090),f=o(808);function b(e){const t=e.channels,o=e.className,c=e.component,r=e.loading,d=e.notifications,u=e.perProjectTypes,b=Object(p.translate)("my_account.notifications"),m=t=>{let o=t.channel,n=t.type;e.addNotification({project:c.key,channel:o,type:n})},k=t=>{let o=t.channel,n=t.type;e.removeNotification({project:c.key,channel:o,type:n})},y=(e,t)=>"project-notification-".concat(c.key,"-").concat(e,"-").concat(t),v=d.filter(e=>e.project&&e.project===c.key);return n.createElement("div",{className:o},n.createElement(s.a,{modal:e=>{let o=e.onClose;return n.createElement(a.a,{contentLabel:b,onRequestClose:o},n.createElement("header",{className:"modal-head"},n.createElement("h2",null,b)),n.createElement("div",{className:"modal-body"},n.createElement(l.Alert,{variant:"info"},Object(p.translate)("notification.dispatcher.information")),n.createElement(h.a,{loading:r},n.createElement("table",{className:"data zebra notifications-table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",{"aria-label":Object(p.translate)("project")}),t.map(e=>n.createElement("th",{className:"text-center",key:e},n.createElement("h4",null,Object(p.translate)("notification.channel",e)))))),n.createElement(f.a,{channels:t,checkboxId:y,notifications:v,onAdd:m,onRemove:k,project:!0,types:u})))),n.createElement("footer",{className:"modal-foot"},n.createElement(i.ResetButtonLink,{className:"js-modal-close",onClick:o},Object(p.translate)("close"))))}},e=>{let t=e.onClick;return n.createElement(i.Button,{onClick:t},n.createElement("span",{"data-test":"overview__edit-notifications"},Object(p.translate)("my_profile.per_project_notifications.edit")))}))}t.default=Object(u.a)(b)},352:function(e,t,o){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0});var c=o(309),a=o(2),r=o(314);o(387);var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.preventDefault(),e.currentTarget.blur(),t.props.disabled||t.props.onCheck(!t.props.checked,t.props.id)},t}return i(t,e),t.prototype.render=function(){var e=this.props,t=e.checked,o=e.children,n=e.disabled,i=e.id,s=e.loading,l=e.right,d=e.thirdState,h=e.title,p=c("icon-checkbox",{"icon-checkbox-checked":t,"icon-checkbox-single":d,"icon-checkbox-disabled":n});return o?a.createElement("a",{"aria-checked":t,className:c("link-checkbox",this.props.className,{note:n,disabled:n}),href:"#",id:i,onClick:this.handleClick,role:"checkbox",title:h},l&&o,a.createElement(r.default,{loading:Boolean(s)},a.createElement("i",{className:p})),!l&&o):s?a.createElement(r.default,null):a.createElement("a",{"aria-checked":t,className:c(p,this.props.className),href:"#",id:i,onClick:this.handleClick,role:"checkbox",title:h})},t.defaultProps={thirdState:!1},t}(a.PureComponent);t.default=s},361:function(e,t,o){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0});var c=o(2),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={modal:!1},t.handleButtonClick=function(){t.setState({modal:!0})},t.handleFormSubmit=function(e){e&&e.preventDefault(),t.setState({modal:!0})},t.handleCloseModal=function(){t.mounted&&t.setState({modal:!1})},t}return i(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){return c.createElement(c.Fragment,null,this.props.children({onClick:this.handleButtonClick,onFormSubmit:this.handleFormSubmit}),this.state.modal&&this.props.modal({onClose:this.handleCloseModal}))},t}(c.PureComponent);t.default=a},387:function(e,t,o){var n=o(388);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};o(313)(n,i);n.locals&&(e.exports=n.locals)},388:function(e,t,o){(e.exports=o(312)(!1)).push([e.i,".icon-checkbox{display:inline-block;line-height:1;vertical-align:top;padding:1px 2px;box-sizing:border-box}a.icon-checkbox{border-bottom:none}.icon-checkbox:focus{outline:none}.icon-checkbox:before{content:\" \";display:inline-block;width:10px;height:10px;border:1px solid #236a97;border-radius:2px;transition:border-color .2s ease,background-color .2s ease,background-image .2s ease,box-shadow .4s ease}.icon-checkbox:not(.icon-checkbox-disabled):focus:before,.link-checkbox:not(.disabled):focus:focus .icon-checkbox:before{box-shadow:0 0 0 3px rgba(35,106,151,.25)}.icon-checkbox-checked:before{background-color:#4b9fd5;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 14 14' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' clip-rule='evenodd' stroke-linejoin='round' stroke-miterlimit='1.414'%3E%3Cpath d='M12 4.665c0 .172-.06.318-.18.438l-5.55 5.55c-.12.12-.266.18-.438.18s-.318-.06-.438-.18L2.18 7.438C2.06 7.317 2 7.17 2 7s.06-.318.18-.44l.878-.876c.12-.12.267-.18.44-.18.17 0 .317.06.437.18l1.897 1.903 4.233-4.24c.12-.12.266-.18.438-.18s.32.06.44.18l.876.88c.12.12.18.265.18.438z' fill='%23fff' fill-rule='nonzero'/%3E%3C/svg%3E\");border-color:#4b9fd5}.icon-checkbox-checked.icon-checkbox-single:before{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 14 14' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' clip-rule='evenodd' stroke-linejoin='round' stroke-miterlimit='1.414'%3E%3Cpath d='M10 4.698A.697.697 0 0 0 9.302 4H4.698A.697.697 0 0 0 4 4.698v4.604c0 .386.312.698.698.698h4.604A.697.697 0 0 0 10 9.302V4.698z' fill='%23fff'/%3E%3C/svg%3E\")}.icon-checkbox-disabled:before{border:1px solid #bbb;cursor:not-allowed}.icon-checkbox-disabled.icon-checkbox-checked:before{background-color:#bbb}.icon-checkbox-invisible{visibility:hidden}.link-checkbox{color:inherit;border-bottom:none}.link-checkbox.disabled,.link-checkbox.disabled:hover,.link-checkbox.disabled label{color:#777;cursor:not-allowed}.link-checkbox:active,.link-checkbox:focus,.link-checkbox:hover{color:inherit}",""])},808:function(e,t,o){"use strict";o.d(t,"a",function(){return r});var n=o(2),i=o(352),c=o.n(i),a=o(5);class r extends n.PureComponent{isEnabled(e,t){return!!this.props.notifications.find(o=>o.type===e&&o.channel===t)}handleCheck(e,t,o){o?this.props.onAdd({type:e,channel:t}):this.props.onRemove({type:e,channel:t})}getDispatcherLabel(e){const t=["notification.dispatcher",e],o=[...t,"project"];return this.props.project&&Object(a.hasMessage)(...o)?Object(a.translate)(...o):Object(a.translate)(...t)}render(){const e=this.props,t=e.channels,o=e.checkboxId,i=e.types;return n.createElement("tbody",null,i.map(e=>n.createElement("tr",{key:e},n.createElement("td",null,this.getDispatcherLabel(e)),t.map(t=>n.createElement("td",{className:"text-center",key:t},n.createElement(c.a,{checked:this.isEnabled(e,t),id:o(e,t),onCheck:o=>this.handleCheck(e,t,o)}))))))}}},877:function(e,t,o){var n=o(790);e.exports=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?n(e,void 0,t):[]}}}]);
//# sourceMappingURL=335.m.1b4cfdd7.chunk.js.map